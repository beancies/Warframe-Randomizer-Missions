<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tenno Mastery Matrix: Official Edition</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --text: #c9d1d9; --accent: #2ea043; --btn: #1f6feb; --frame: #d2a8ff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { max-width: 800px; width: 100%; }
        .upload-zone { border: 2px dashed #30363d; padding: 20px; text-align: center; border-radius: 8px; margin-bottom: 20px; background: #0d1117; }
        .btn-roll { background: var(--btn); color: white; border: none; padding: 15px 30px; border-radius: 6px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1em; }
        #result { background: var(--card); border: 1px solid #30363d; padding: 25px; border-radius: 12px; margin-top: 20px; display: none; border-left: 8px solid var(--frame); }
        .target { font-size: 2.2em; font-weight: bold; margin: 10px 0; color: #fff; }
        .location { color: var(--accent); font-family: monospace; font-size: 1.2em; margin-bottom: 15px; }
        #statusInfo { margin-top: 10px; font-weight: bold; color: #8b949e; }
    </style>
</head>
<body>

<div class="container">
    <h1>Mastery Matrix: Official Items</h1>
    <div class="upload-zone">
        <p>Drop AlecaFrame JSON here</p>
        <input type="file" id="fileInput" accept=".json">
        <div id="statusInfo">Awaiting Data...</div>
    </div>

    <button class="btn-roll" onclick="generateObjective()">FIND REAL MISSING ITEM</button>

    <div id="result">
        <div id="cCat" style="text-transform: uppercase; font-size: 0.8em; color: #8b949e;">Category</div>
        <div class="target" id="cName">Target</div>
        <div class="location" id="cLoc">Location</div>
        <div id="cReason" style="padding: 10px; background: rgba(210, 168, 255, 0.1); border-radius: 4px;">Reason</div>
    </div>
</div>

<script>
    // --- OFFICIAL NON-RELIC DATABASE ---
    // This list only contains REAL items. 
    const OFFICIAL_DB = [
        { name: "ATLAS", loc: "Jordas Precept", cat: "Frame" },
        { name: "BARUUK", loc: "Vox Solaris (Little Duck)", cat: "Frame" },
        { name: "CALIBAN", loc: "Narmer Bounties", cat: "Frame" },
        { name: "CITRINE", loc: "Tyana Pass (Mars)", cat: "Frame" },
        { name: "DAGATH", loc: "Abyssal Zone", cat: "Frame" },
        { name: "DANTE", loc: "Armatus (Deimos)", cat: "Frame" },
        { name: "EXCALIBUR UMRA", loc: "The Sacrifice Quest", cat: "Frame" },
        { name: "GRENDEL", loc: "Arbitration Missions", cat: "Frame" },
        { name: "GYRE", loc: "Zariman Bounties", cat: "Frame" },
        { name: "KULLERVO", loc: "Duviri (Kullervo's Hold)", cat: "Frame" },
        { name: "PROTEA", loc: "Granum Void", cat: "Frame" },
        { name: "SEVAGOTH", loc: "Railjack Void Storms", cat: "Frame" },
        { name: "VORUNA", loc: "Conjunction Survival (Lua)", cat: "Frame" },
        { name: "WISP", loc: "Ropalolyst (Jupiter)", cat: "Frame" },
        { name: "IGNIS WRAITH", loc: "Dojo (Chem Lab)", cat: "Weapon" },
        { name: "BUBONICO", loc: "Dojo (Bio Lab)", cat: "Weapon" },
        { name: "CEDO", loc: "Father (Necralisk)", cat: "Weapon" },
        { name: "PHENMOR", loc: "Cavalero (Zariman)", cat: "Weapon" },
        { name: "NATARUK", loc: "The New War Quest", cat: "Weapon" },
        { name: "XORIS", loc: "The Deadlock Protocol", cat: "Weapon" },
        { name: "DEX FURIS", loc: "Anniversary Gift (March)", cat: "Weapon" },
        { name: "DEX DAKRA", loc: "Anniversary Gift (March)", cat: "Weapon" },
        { name: "DEX SYBARIS", loc: "Anniversary Gift (March)", cat: "Weapon" }
        // ... (You can add any other specific real weapons you are hunting here)
    ];

    let mastered = new Set();
    let subsumed = new Set();

    document.getElementById('fileInput').addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = (event) => {
            const data = JSON.parse(event.target.result);
            mastered.clear();

            // REFINED PARSER: Iterates through Aleca's complex objects
            // We search for anything that looks like an item with XP or a 'mastered' flag
            function searchMastery(obj) {
                for (let key in obj) {
                    if (typeof obj[key] === 'object' && obj[key] !== null) {
                        // If the object has 'mastered: true' or 'xp' > 0
                        if (obj[key].mastered === true || (obj[key].xp && obj[key].xp > 0)) {
                            mastered.add(key.toUpperCase().replace(/_/, " "));
                        }
                        searchMastery(obj[key]);
                    }
                }
            }
            searchMastery(data);

            // Also check standard helminth path
            const subsumeList = data.helminth?.subsumed || [];
            subsumeList.forEach(s => subsumed.add(s.toUpperCase()));

            document.getElementById('statusInfo').innerText = `âœ… DATA SYNCED: ${mastered.size} Items Found.`;
        };
        reader.readAsText(e.target.files[0]);
    });

    function generateObjective() {
        const pool = OFFICIAL_DB.filter(item => !mastered.has(item.name));

        if (pool.length === 0) {
            alert("No missing items from the official list found!");
            return;
        }

        const win = pool[Math.floor(Math.random() * pool.length)];

        document.getElementById('cCat').innerText = win.cat;
        document.getElementById('cName').innerText = win.name;
        document.getElementById('cLoc').innerText = win.loc;
        document.getElementById('cReason').innerText = `This is a verified real ${win.cat} you are currently missing.`;
        document.getElementById('result').style.display = 'block';
    }
</script>
</body>
</html>
